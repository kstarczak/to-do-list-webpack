(()=>{"use strict";const t=function(){const t={};return{subscribe:function(e,n){t[e]||(t[e]=[]),t[e].push(n)},unsubscribe:function(e,n){t[e]&&t[e].filter((t=>t!==n))},publish:function(e,n){t[e]&&t[e].forEach((t=>t(n)))},eventList:()=>t}}(),e=function(t){for(;t.firstChild;)t.removeChild(t.lastChild)},n={add:function(t){t.id=this.idCount,this.idCount++,this.list.push(t)},delete:function(e){this.list=this.list.filter((t=>t.id!==e));const n=this.list;t.publish(`${this.type}Modified`,n)},select:function(e){this.list.forEach((function(t){t.id===e?t.selected=!0:t.selected=!1}));const n=this.list,c=n.find((t=>t.selected)).list;t.publish(`${this.type}Modified`,n),t.publish(`${this.type}Selected`,c)}},c=function(t){return Object.assign(Object.create(n),{name:t,type:"projectList",selected:!1,list:[],idCount:1})},o=function(t){const{name:e,color:c="PowderBlue"}=t;return Object.assign(Object.create(n),{name:e,type:"project",selected:!1,color:c,list:[],idCount:1})},s=function(t){const{name:e,description:c=null,due:o=null,proiority:s="normal"}=t,{select:d}={listObject:n};return{name:e,description:c,due:o,proiority:s,type:"task",selected:!1,select:d}},d=function(){const e=[],n=function(t){if(e.find((e=>e.name===t))){const e=prompt(`A user with the name "${t}" already exists! Please enter a new user name.`);n(e)}else{const n=c(t);e.push(n),o(n)}},o=function(n){e.includes(n)&&!n.selected&&(e.forEach((t=>t.selected=!1)),n.selected=!0,t.publish("userSelected",n))};return{addUser:n,switchUser:o,currentUser:function(){return e.find((t=>t.selected))}}}(),i=function(){return d.currentUser().list.find((t=>t.selected))};t.subscribe("addUser",d.addUser),t.subscribe("selectUser",d.switchUser),t.subscribe("selectProject",(function(t){d.currentUser().select(t)})),t.subscribe("addProject",(function(t){const e=d.currentUser(),n=o(t);e.add(n),e.select(n.id)})),t.subscribe("deleteProject",(function(e){const n=d.currentUser();if(i().id===e){const e="Create a new project or select a curent project to add tasks.";t.publish("currentProjectDeleted",e)}n.delete(e)})),t.subscribe("addTask",(function(t){const e=i(),n=s(t);e.add(n),e.select(n.id)})),t.subscribe("deleteTask",(function(t){i().delete(t)}));const r=function(t){const n=document.querySelector(".content");e(n);const c=document.createElement("nav");c.classList.add("main-header"),c.textContent=`${t.name}'s To Do List`;const o=document.createElement("div");o.classList.add("project-content");const s=document.createElement("div");s.classList.add("task-content"),n.append(c,o,s),a.load(),l.load()};t.subscribe("userSelected",r);const a=function(){const n=function(e){let n=e.target.id;n=parseInt(n.replace("project","")),t.publish("selectProject",n)},c=function(e){let n=e.target.previousSibling.id;n=parseInt(n.replace("project","")),t.publish("deleteProject",n)},o=function(){const n=document.querySelector(".content-cover"),c=document.querySelector(".forms");function o(){e(c),n.style.display="none"}function s(){const e={name:document.querySelector("#name").value,color:document.querySelector("#color").value};o(),t.publish("addProject",e)}!function(){n.style.display="block";const t=document.createElement("div");t.classList.add("form"),t.setAttribute("autocomplete","off");const e=document.createElement("div");e.textContent="Create New Project";const d=document.createElement("input");d.id="name",d.setAttribute("type","text"),d.setAttribute("autocomplete","off"),d.placeholder="Enter project name";const i=document.createElement("div");i.classList.add("color-selector");const r=document.createElement("label");r.setAttribute("for","color"),r.textContent="Choose a color (optional)";const a=document.createElement("input");a.type="color",a.id="color",a.value="#f6b73c",a.addEventListener("change",(function(){r.style.backgroundColor=this.value})),i.append(r,a);const l=document.createElement("div");l.classList.add("buttons");const u=document.createElement("button");u.classList.add("button"),u.id="cancel-button",u.textContent="Cancel",u.addEventListener("click",o);const p=document.createElement("button");p.classList.add("button"),p.id="submit-button",p.textContent="Create",p.addEventListener("click",s),l.append(u,p),t.append(e,d,i,l),c.append(t)}()};return{load:function(){const t=document.querySelector(".project-content");e(t);const n=document.createElement("div");n.classList.add("project-container");const c=document.createElement("div");c.classList.add("project-header"),c.textContent="Your Projects:";const s=document.createElement("button");s.classList.add("collapse-projects-button");const d=document.createElement("ul");d.classList.add("project-list");const i=document.createElement("button");i.type="button",i.classList.add("add-project-button"),i.textContent="Add Project",i.addEventListener("click",o),n.append(c,s,d,i),t.append(n)},loadList:function(t){const o=document.querySelector(".project-list");e(o),t.forEach((function(t){const e=document.createElement("span");e.textContent=t.name,e.id=t.type+t.id,e.classList.add("project-link");const s=document.createElement("button");s.type="button",s.classList.add("delete-project-button"),s.textContent="X";const d=document.createElement("li");d.style.backgroundColor=t.color,d.append(e,s),t.selected&&(e.classList.add("selected"),e.parentElement.classList.add("selected")),o.appendChild(d),e.addEventListener("click",n),s.addEventListener("click",c)}))}}}();t.subscribe("projectListModified",a.loadList);const l=function(){function n(e){let n=e.target.parentElement.id;n=parseInt(n.replace("task","")),t.publish("deleteTask",n)}const c=function(){const n=document.querySelector(".content-cover"),c=document.querySelector(".forms");function o(){e(c),n.style.display="none"}function s(){const e={name:document.querySelector("#name").value,description:document.querySelector("#description").value};o(),t.publish("addTask",e)}!function(){n.style.display="block";const t=document.createElement("div");t.classList.add("form");const e=document.createElement("div");e.textContent="Create New Task";const d=document.createElement("input");d.id="name",d.setAttribute("type","text"),d.placeholder="Enter Task name",d.setAttribute("autocomplete","off");const i=document.createElement("textarea");i.id="description",i.placeholder="Enter a description(optional)",i.setAttribute("autocomplete","off"),i.setAttribute("rows","4");const r=document.createElement("div");r.classList.add("buttons");const a=document.createElement("button");a.classList.add("button"),a.id="cancel-button",a.textContent="Cancel",a.addEventListener("click",o);const l=document.createElement("button");l.classList.add("button"),l.id="submit-button",l.textContent="Create",l.addEventListener("click",s),r.append(a,l),t.append(e,d,i,r),c.append(t)}()};return{load:function(){const t=document.querySelector(".task-content");e(t);const n=document.createElement("div");n.classList.add("task-container");const o=document.createElement("div");o.classList.add("task-header"),o.textContent="";const s=document.createElement("ul");s.classList.add("task-list");const d=document.createElement("button");d.type="button",d.classList.add("add-task-button"),d.textContent="Add Task",d.addEventListener("click",c),d.style.display="none",n.append(o,s,d),t.append(n)},loadList:function(t){const c=document.querySelector(".add-task-button");"none"===c.style.display&&(c.style.display="block");const o=document.querySelector(".task-list");e(o),t.forEach((function(t){const e=document.createElement("li");e.id=t.type+t.id,e.classList.add("task-link");const c=document.createElement("div");c.classList.add("task-name"),c.textContent=t.name;const s=document.createElement("div");s.classList.add("task-description"),s.textContent=t.description;const d=document.createElement("button");d.classList.add("delete-task-button"),d.type="button",d.textContent="x",e.append(c,s,d),o.append(e),d.addEventListener("click",n)}))},clear:function(t){const n=document.querySelector(".task-list");e(n);const c=document.createElement("div");c.textContent=t,n.appendChild(c)}}}();t.subscribe("projectModified",l.loadList),t.subscribe("projectListSelected",l.loadList),t.subscribe("currentProjectDeleted",l.clear),d.addUser("Konrad"),document.querySelector(".collapse-projects-button").addEventListener("click",(function(){const t=document.querySelectorAll(".project-list li");console.log(t),t.forEach((t=>t.classList.toggle("collapsed")))}))})();